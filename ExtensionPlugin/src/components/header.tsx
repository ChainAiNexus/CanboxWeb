import { useEffect, useRef, useState } from "react";
import { AddrHandle } from "../utils";

interface TabProps {
  index?: number;
}

function App(props: TabProps) {
  // 
  const [webMes, setWebMes]: any = useState();
  useEffect(() => {
    chrome?.runtime?.onMessageExternal?.addListener(
      async (request, sender, sendResponse) => {
        // 
        if (request.event === "login") {
          setWebMes(request?.data);
          console.log("web");
          console.log(request?.data);
          sendResponse("chrome");
        }
      }
    );
  }, []);
  // 
  const openBaiduButton: any = useRef(null);
  useEffect(() => {
    const _this: any = window;
    const handleClick = () => {
      if (webMes?.address) {
        return;
      }
      if (typeof _this !== "undefined" && _this?.chrome && _this?.chrome.tabs) {
        _this?.chrome.tabs.create({
          url: "https://dapp.chainainexus.com/",
        });
      } else {
        window.open("https://dapp.chainainexus.com/");
      }
    };
    openBaiduButton.current?.addEventListener("click", handleClick);

    return () => {
      openBaiduButton.current?.removeEventListener("click", handleClick);
    };
  }, []);

  return (
    <div className="fixed top-0 left-auto w-[375px] px-10 py-8 flex justify-center items-center">
      <div
        className="w-[160px] text-center flex justify-center items-center px-10 py-6 text-[14px] text-[#fafafa] cursor-pointer"
        style={{
          borderRadius: "5rem",
          border: "1px solid rgba(255, 255, 255, 0.00)",
          background: "rgba(255, 255, 255, 0.10)",
          boxShadow: "4px 4px 16px 0px rgba(131, 225, 255, 0.25) inset",
          backdropFilter: "blur(20px)",
        }}
        ref={openBaiduButton}
      >
        {AddrHandle(webMes?.address) || "Connect Wallet"}

        <div className="flex-1"></div>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
        >
          <path
            d="M7 20L2 15L7 10L8.4 11.425L5.825 14H13V16H5.825L8.4 18.575L7 20ZM17 14L15.6 12.575L18.175 10H11V8H18.175L15.6 5.425L17 4L22 9L17 14Z"
            fill="white"
          />
        </svg>
      </div>
      <div className="flex-1"></div>
      <div className="flex flex-1 text-center">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
        >
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M5.21493 1.50977C4.09581 1.50977 3.49253 2.19751 3.49253 3.31663C3.49253 3.50568 3.51842 3.68868 3.56684 3.86228C3.71739 4.402 4.03123 4.91911 4.34505 5.43618C4.78001 6.15287 5.21493 6.86949 5.21493 7.64612V15.0757C5.21493 15.8666 4.76326 16.5971 4.31159 17.3277C4.08365 17.6963 3.85571 18.065 3.68583 18.4414C3.49838 18.7485 3.39038 19.1094 3.39038 19.4956C3.39038 20.6147 4.29761 21.5219 5.41673 21.5219C5.4227 21.5219 5.42867 21.5219 5.43463 21.5218C5.43991 21.5219 5.44521 21.5219 5.4505 21.5219C6.56963 21.5219 7.51146 20.3548 7.51146 19.6456C7.51146 19.0332 7.63404 18.5635 8.17003 18.1422L18.9549 9.1884C19.4179 8.82451 20.0886 8.73885 20.6828 8.85529C21.9155 9.15925 22.9077 8.52327 23.1819 7.33553C23.4337 6.24509 22.9242 5.34011 21.8338 5.08836C21.6554 5.04717 21.477 5.03092 21.3023 5.03733C21.2902 5.03741 21.2781 5.03759 21.266 5.03788C20.6435 5.05287 19.9984 5.2824 19.3532 5.51196C18.506 5.81337 17.6587 6.11485 16.8622 5.93096L10.139 4.37879C9.32978 4.19197 8.69033 3.53002 8.05111 2.86831C7.37089 2.16416 6.27408 1.50977 5.21493 1.50977ZM18.8928 7.53816C18.6902 6.74451 17.7273 6.47729 16.9567 6.29938L9.7175 4.62809C8.93879 4.44831 7.55633 4.67585 6.86529 5.14055C6.17594 5.60412 5.55266 7.23169 5.55266 8.00072L5.4505 15.0757C5.4505 16.319 6.02547 17.0529 6.34631 17.3277C6.66715 17.6024 7.73099 18.1422 8.17003 17.7712L18.3948 9.19902C18.7781 8.89779 19.0954 8.33182 18.8928 7.53816Z"
            fill="white"
            fill-opacity="0.69"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M15.3287 0.699914C15.0436 0.0919611 14.3197 -0.169777 13.7117 0.115305C13.3954 0.26362 13.1933 0.564256 12.9575 0.811316C12.6178 1.16729 12.2738 1.5278 11.824 1.6208L8.37832 2.33329C7.81643 2.44947 7.26891 2.15707 6.78705 1.82132C6.65781 1.70697 6.51652 1.61152 6.36715 1.53541C6.20302 1.44387 6.0233 1.37381 5.83085 1.3298C4.7399 1.08029 3.65324 1.76242 3.40373 2.85338C3.264 3.46436 3.41647 4.07399 3.76931 4.53598C4.01234 5.13788 4.19505 5.8021 3.91161 6.35627L2.39153 9.32837C2.18919 9.724 1.77155 9.95216 1.35782 10.1782C1.15682 10.288 0.956738 10.3973 0.782717 10.5251C0.770777 10.5338 0.75895 10.5429 0.747239 10.5521C0.479223 10.7642 0.324525 11.0664 0.292154 11.3814C0.286726 11.4281 0.283936 11.4755 0.283936 11.5236C0.283936 11.913 0.472885 12.2508 0.753471 12.4705C0.929607 12.6084 1.13498 12.7281 1.34162 12.8485C1.76282 13.0939 2.18932 13.3425 2.38429 13.7546L3.81506 16.7793C4.09887 17.3793 3.84692 18.0889 3.58646 18.6994C3.48238 18.9434 3.42478 19.2119 3.42478 19.4939C3.42478 20.613 4.33201 21.5202 5.45113 21.5202C5.86959 21.5202 6.25844 21.3934 6.58129 21.1761L6.58247 21.1753C7.11949 20.8138 7.74987 20.4472 8.37864 20.6005L11.9069 21.4608C12.3419 21.5668 12.6654 21.9233 12.985 22.2757C13.1046 22.4075 13.2237 22.5387 13.3478 22.656C13.4347 22.7473 13.5356 22.825 13.6469 22.8858C13.8207 22.9837 14.0203 23.04 14.232 23.04C14.9035 23.04 15.4478 22.4957 15.4478 21.8242C15.4478 21.3714 15.2003 20.9764 14.8331 20.7671C14.6874 20.6671 14.5284 20.5751 14.3686 20.4825L14.3685 20.4824C13.937 20.2325 13.4998 19.9793 13.3039 19.5586L10.8555 14.3012C10.3799 13.2799 11.4002 12.657 11.4687 11.6981C11.621 10.5893 10.3556 9.75944 10.917 8.61614L13.3724 3.61513C13.6352 3.07989 14.0337 2.58095 14.6204 2.50629C15.2071 2.43163 15.6699 2.62127 15.978 2.88274L18.6611 5.1591C19.1621 5.58418 19.2293 6.3243 19.2475 6.9811C19.255 7.25113 19.3169 7.52408 19.4389 7.78428C19.9141 8.79753 21.1206 9.23376 22.1339 8.75862C23.1471 8.28349 23.5834 7.07691 23.1082 6.06366C22.6953 5.18308 21.7396 4.79159 20.8749 4.95244C20.1392 5.08928 19.2597 5.22454 18.6892 4.74042L16.1437 2.5806C15.8049 2.2931 15.6783 1.83433 15.553 1.37986C15.4898 1.15082 15.4299 0.915838 15.3287 0.699914ZM11.9601 1.9374C12.3552 1.85571 12.9271 1.81665 13.1497 2.16147C13.3724 2.50629 13.2645 3.06848 13.0757 3.45305L10.5423 8.6121C10.299 9.10763 9.76603 9.36016 9.22355 9.53106C8.83274 9.57551 8.47681 9.73061 8.18681 9.9636C7.48285 10.4864 7.10528 11.4897 6.07122 11.4627L3.95211 11.4075C3.46929 11.3949 2.79999 11.0507 2.63948 10.7699C2.47898 10.489 2.52035 9.81793 2.72357 9.42054L4.32562 6.28781C4.62478 5.70282 5.32988 5.468 5.96508 5.30001C6.22624 5.23095 6.47778 5.10822 6.70316 4.92991C7.09556 4.61945 7.30399 4.09163 7.43295 3.738C7.56192 3.38438 8.12668 2.72986 8.69094 2.61321L11.9601 1.9374ZM8.06538 13.121C8.8021 13.854 10.1984 13.6879 10.6785 14.719L13.0492 19.8107C13.2075 20.1507 13.3039 20.6084 13.1199 20.9302C12.9359 21.252 12.3142 21.2124 11.9225 21.117L8.74983 20.3434C8.07065 20.1778 7.66948 19.4777 7.36252 18.83C7.27246 18.5798 7.13336 18.3548 6.95916 18.1632C6.6462 17.8054 6.21185 17.5523 5.71527 17.4852C5.0447 17.3082 4.3184 17.0536 4.02965 16.4432L2.67523 13.5799C2.49797 13.2052 2.43854 12.7255 2.61927 12.3356C2.79999 11.9457 3.50618 11.7337 3.99965 11.7465L6.2984 11.8063C7.19245 11.8296 7.50811 12.6359 8.06538 13.121Z"
            fill="white"
          />
        </svg>
        <svg
          className="mx-16"
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
        >
          <path
            d="M20.317 4.15557C18.7873 3.45369 17.147 2.93658 15.4319 2.6404C15.4007 2.63469 15.3695 2.64897 15.3534 2.67754C15.1424 3.05276 14.9087 3.54225 14.7451 3.927C12.9004 3.65083 11.0652 3.65083 9.25832 3.927C9.09465 3.5337 8.85248 3.05276 8.64057 2.67754C8.62449 2.64992 8.59328 2.63564 8.56205 2.6404C6.84791 2.93563 5.20756 3.45275 3.67693 4.15557C3.66368 4.16129 3.65233 4.17082 3.64479 4.18319C0.533392 8.83155 -0.31895 13.3657 0.0991801 17.8436C0.101072 17.8655 0.11337 17.8864 0.130398 17.8997C2.18321 19.4073 4.17171 20.3225 6.12328 20.9291C6.15451 20.9386 6.18761 20.9272 6.20748 20.9015C6.66913 20.2711 7.08064 19.6063 7.43348 18.9073C7.4543 18.8664 7.43442 18.8178 7.39186 18.8016C6.73913 18.554 6.1176 18.2521 5.51973 17.9093C5.47244 17.8816 5.46865 17.814 5.51216 17.7816C5.63797 17.6873 5.76382 17.5893 5.88396 17.4902C5.90569 17.4721 5.93598 17.4683 5.96153 17.4797C9.88928 19.273 14.1415 19.273 18.023 17.4797C18.0485 17.4674 18.0788 17.4712 18.1015 17.4893C18.2216 17.5883 18.3475 17.6873 18.4742 17.7816C18.5177 17.814 18.5149 17.8816 18.4676 17.9093C17.8697 18.2588 17.2482 18.554 16.5945 18.8006C16.552 18.8168 16.533 18.8664 16.5538 18.9073C16.9143 19.6054 17.3258 20.2701 17.7789 20.9005C17.7978 20.9272 17.8319 20.9386 17.8631 20.9291C19.8241 20.3225 21.8126 19.4073 23.8654 17.8997C23.8834 17.8864 23.8948 17.8664 23.8967 17.8445C24.3971 12.6676 23.0585 8.17064 20.3482 4.18414C20.3416 4.17082 20.3303 4.16129 20.317 4.15557ZM8.02002 15.117C6.8375 15.117 5.86313 14.0313 5.86313 12.6981C5.86313 11.3648 6.8186 10.2791 8.02002 10.2791C9.23087 10.2791 10.1958 11.3743 10.1769 12.6981C10.1769 14.0313 9.22141 15.117 8.02002 15.117ZM15.9947 15.117C14.8123 15.117 13.8379 14.0313 13.8379 12.6981C13.8379 11.3648 14.7933 10.2791 15.9947 10.2791C17.2056 10.2791 18.1705 11.3743 18.1516 12.6981C18.1516 14.0313 17.2056 15.117 15.9947 15.117Z"
            fill="white"
          />
        </svg>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
        >
          <path
            d="M18.3263 1.90381H21.6998L14.3297 10.3273L23 21.7898H16.2112L10.894 14.8378L4.80995 21.7898H1.43443L9.31743 12.7799L1 1.90381H7.96111L12.7674 8.25814L18.3263 1.90381ZM17.1423 19.7706H19.0116L6.94539 3.81694H4.93946L17.1423 19.7706Z"
            fill="white"
          />
        </svg>
      </div>
    </div>
  );
}

export default App;
